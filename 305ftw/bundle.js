var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function c(t){return"function"==typeof t}function l(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function r(t,n){t.appendChild(n)}function s(t,n,e){t.insertBefore(n,e||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function i(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function a(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function h(){return f("")}function p(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function m(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function g(t){return""===t?null:+t}function v(t,n){n=""+n,t.data!==n&&(t.data=n)}function b(t,n){t.value=null==n?"":n}function k(t,n,e){t.classList[e?"add":"remove"](n)}let $;function y(t){$=t}function x(){if(!$)throw new Error("Function called outside component initialization");return $}const _=[],C=[];let S=[];const E=[],w=Promise.resolve();let N=!1;function j(t){S.push(t)}const O=new Set;let T=0;function P(){if(0!==T)return;const t=$;do{try{for(;T<_.length;){const t=_[T];T++,y(t),A(t.$$)}}catch(t){throw _.length=0,T=0,t}for(y(null),_.length=0,T=0;C.length;)C.pop()();for(let t=0;t<S.length;t+=1){const n=S[t];O.has(n)||(O.add(n),n())}S.length=0}while(_.length);for(;E.length;)E.pop()();N=!1,O.clear(),y(t)}function A(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(j)}}const L=new Set;let F;function U(t,n){t&&t.i&&(L.delete(t),t.i(n))}function z(t,n){const e=n.token={};function c(t,c,l,r){if(n.token!==e)return;n.resolved=r;let s=n.ctx;void 0!==l&&(s=s.slice(),s[l]=r);const u=t&&(n.current=t)(s);let i=!1;n.block&&(n.blocks?n.blocks.forEach(((t,e)=>{e!==c&&t&&(F={r:0,c:[],p:F},function(t,n,e,o){if(t&&t.o){if(L.has(t))return;L.add(t),F.c.push((()=>{L.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}else o&&o()}(t,1,1,(()=>{n.blocks[e]===t&&(n.blocks[e]=null)})),F.r||o(F.c),F=F.p)})):n.block.d(1),u.c(),U(u,1),u.m(n.mount(),n.anchor),i=!0),n.block=u,n.blocks&&(n.blocks[c]=u),i&&P()}if(!(l=t)||"object"!=typeof l&&"function"!=typeof l||"function"!=typeof l.then){if(n.current!==n.then)return c(n.then,1,n.value,t),!0;n.resolved=t}else{const e=x();if(t.then((t=>{y(e),c(n.then,1,n.value,t),y(null)}),(t=>{if(y(e),c(n.catch,2,n.error,t),y(null),!n.hasCatch)throw t})),n.current!==n.pending)return c(n.pending,0),!0}var l}function G(t,n,e){const o=n.slice(),{resolved:c}=t;t.current===t.then&&(o[t.value]=c),t.current===t.catch&&(o[t.error]=c),t.block.p(o,e)}function J(t,n){const e=t.$$;null!==e.fragment&&(!function(t){const n=[],e=[];S.forEach((o=>-1===t.indexOf(o)?n.push(o):e.push(o))),e.forEach((t=>t())),S=n}(e.after_update),o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function B(t,n){-1===t.$$.dirty[0]&&(_.push(t),N||(N=!0,w.then(P)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function M(l,r,s,i,a,f,d,h=[-1]){const p=$;y(l);const m=l.$$={fragment:null,ctx:[],props:f,update:t,not_equal:a,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(p?p.$$.context:[])),callbacks:e(),dirty:h,skip_bound:!1,root:r.target||p.$$.root};d&&d(m.root);let g=!1;if(m.ctx=s?s(l,r.props||{},((t,n,...e)=>{const o=e.length?e[0]:n;return m.ctx&&a(m.ctx[t],m.ctx[t]=o)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](o),g&&B(l,t)),n})):[],m.update(),g=!0,o(m.before_update),m.fragment=!!i&&i(m.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);m.fragment&&m.fragment.l(t),t.forEach(u)}else m.fragment&&m.fragment.c();r.intro&&U(l.$$.fragment),function(t,e,l,r){const{fragment:s,after_update:u}=t.$$;s&&s.m(e,l),r||j((()=>{const e=t.$$.on_mount.map(n).filter(c);t.$$.on_destroy?t.$$.on_destroy.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(j)}(l,r.target,r.anchor,r.customElement),P()}y(p)}class q{$destroy(){J(this,1),this.$destroy=t}$on(n,e){if(!c(e))return t;const o=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return o.push(e),()=>{const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function D(t,n,e){const o=t.slice();return o[28]=n[e],o}function H(t,n,e){const o=t.slice();return o[31]=n[e],o}function W(t,n,e){const o=t.slice();return o[34]=n[e],o}function I(n){let e,o,c;return{c(){e=a("button"),e.textContent="Find backend",m(e,"class","svelte-1tg273s")},m(t,l){s(t,e,l),o||(c=p(e,"click",n[11]),o=!0)},p:t,d(t){t&&u(e),o=!1,c()}}}function K(t){let n,e,c,l,r,i,h,v;return{c(){n=a("button"),n.textContent="Get tracks from watch",e=d(),c=a("input"),l=f("days ago until\n  "),r=a("input"),i=f("days ago"),m(n,"class","svelte-1tg273s"),m(c,"type","number"),m(c,"min","0"),m(c,"size","1"),m(r,"type","number"),m(r,"min","0"),m(r,"size","1")},m(o,u){s(o,n,u),s(o,e,u),s(o,c,u),b(c,t[3]),s(o,l,u),s(o,r,u),b(r,t[4]),s(o,i,u),h||(v=[p(n,"click",t[12]),p(c,"input",t[16]),p(r,"input",t[17])],h=!0)},p(t,n){8&n[0]&&g(c.value)!==t[3]&&b(c,t[3]),16&n[0]&&g(r.value)!==t[4]&&b(r,t[4])},d(t){t&&u(n),t&&u(e),t&&u(c),t&&u(l),t&&u(r),t&&u(i),h=!1,o(v)}}}function Q(n){return{c:t,m:t,d:t}}function R(n){return{c:t,m:t,d:t}}function V(t){let n,e;return{c(){n=a("i"),e=f("Fetching GPS data from watch"),m(n,"class","fas fa-spinner fa-spin")},m(t,o){s(t,n,o),s(t,e,o)},d(t){t&&u(n),t&&u(e)}}}function X(t){let n,e,o;return{c(){n=a("article"),e=f("An error occurred:\n"),o=f(t[9]),m(n,"class","svelte-1tg273s")},m(t,c){s(t,n,c),r(n,e),r(n,o)},p(t,n){512&n[0]&&v(o,t[9])},d(t){t&&u(n)}}}function Y(n){return{c:t,m:t,p:t,d:t}}function Z(t){let n,e,o;function c(){return t[18](t[34])}return{c(){n=a("button"),n.textContent="Check livelox",m(n,"class","svelte-1tg273s")},m(t,l){s(t,n,l),e||(o=p(n,"click",c),e=!0)},p(n,e){t=n},d(t){t&&u(n),e=!1,o()}}}function tt(t){let n,e,o,c=t[5]===t[34].id&&nt();return{c(){n=a("button"),n.textContent="Check livelox",e=d(),c&&c.c(),o=h(),n.disabled=!0,m(n,"class","svelte-1tg273s")},m(t,l){s(t,n,l),s(t,e,l),c&&c.m(t,l),s(t,o,l)},p(t,n){t[5]===t[34].id?c||(c=nt(),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(t){t&&u(n),t&&u(e),c&&c.d(t),t&&u(o)}}}function nt(t){let n;return{c(){n=a("i"),m(n,"class","fas fa-spinner fa-pulse")},m(t,e){s(t,n,e)},d(t){t&&u(n)}}}function et(t){let n,e,o,c,l,i,h,p,g,b,$,y,x=t[34].starttime+"",_=t[34].dur_min+"",C=String(t[34].dur_sec).padStart(2,"0")+"",S={ctx:t,current:null,token:null,hasCatch:!1,pending:tt,then:Z,catch:Y};return z($=t[6],S),{c(){n=a("tr"),e=a("td"),o=f(x),c=d(),l=a("td"),i=f(_),h=f(":"),p=f(C),g=d(),b=a("td"),S.block.c(),y=d(),m(e,"class","svelte-1tg273s"),m(l,"class","svelte-1tg273s"),m(b,"class","svelte-1tg273s"),m(n,"class","svelte-1tg273s"),k(n,"active",t[5]===t[34].id)},m(t,u){s(t,n,u),r(n,e),r(e,o),r(n,c),r(n,l),r(l,i),r(l,h),r(l,p),r(n,g),r(n,b),S.block.m(b,S.anchor=null),S.mount=()=>b,S.anchor=null,r(n,y)},p(e,c){t=e,1&c[0]&&x!==(x=t[34].starttime+"")&&v(o,x),1&c[0]&&_!==(_=t[34].dur_min+"")&&v(i,_),1&c[0]&&C!==(C=String(t[34].dur_sec).padStart(2,"0")+"")&&v(p,C),S.ctx=t,64&c[0]&&$!==($=t[6])&&z($,S)||G(S,t,c),33&c[0]&&k(n,"active",t[5]===t[34].id)},d(t){t&&u(n),S.block.d(),S.token=null,S=null}}}function ot(n){let e,o,c=n[31]+"";return{c(){e=a("option"),o=f(c),e.__value=n[31],e.value=e.__value},m(t,n){s(t,e,n),r(e,o)},p:t,d(t){t&&u(e)}}}function ct(n){return{c:t,m:t,p:t,d:t}}function lt(t){let n,e,o;function c(){return t[19](t[28])}return{c(){n=a("button"),n.textContent="Upload to this event",m(n,"class","svelte-1tg273s")},m(t,l){s(t,n,l),e||(o=p(n,"click",c),e=!0)},p(n,e){t=n},d(t){t&&u(n),e=!1,o()}}}function rt(t){let n,e,o,c=t[10]===t[28].id&&st();return{c(){n=a("button"),n.textContent="Upload to this event",e=d(),c&&c.c(),o=h(),n.disabled=!0,m(n,"class","svelte-1tg273s")},m(t,l){s(t,n,l),s(t,e,l),c&&c.m(t,l),s(t,o,l)},p(t,n){t[10]===t[28].id?c||(c=st(),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(t){t&&u(n),t&&u(e),c&&c.d(t),t&&u(o)}}}function st(t){let n;return{c(){n=a("i"),m(n,"class","fas fa-spinner fa-pulse")},m(t,e){s(t,n,e)},d(t){t&&u(n)}}}function ut(t){let n,e,o,c,l,i,h,p,g,b=t[28].eventname+"",$=t[28].name+"",y={ctx:t,current:null,token:null,hasCatch:!1,pending:rt,then:lt,catch:ct};return z(p=t[8],y),{c(){n=a("tr"),e=a("td"),o=f(b),c=f(", "),l=f($),i=d(),h=a("td"),y.block.c(),g=d(),m(e,"class","svelte-1tg273s"),m(h,"class","svelte-1tg273s"),m(n,"class","svelte-1tg273s"),k(n,"active",t[10]===t[28].id)},m(t,u){s(t,n,u),r(n,e),r(e,o),r(e,c),r(e,l),r(n,i),r(n,h),y.block.m(h,y.anchor=null),y.mount=()=>h,y.anchor=null,r(n,g)},p(e,c){t=e,2&c[0]&&b!==(b=t[28].eventname+"")&&v(o,b),2&c[0]&&$!==($=t[28].name+"")&&v(l,$),y.ctx=t,256&c[0]&&p!==(p=t[8])&&z(p,y)||G(y,t,c),1026&c[0]&&k(n,"active",t[10]===t[28].id)},d(t){t&&u(n),y.block.d(),y.token=null,y=null}}}function it(n){let e,o,c,l,f,h,p,g,v,b,k,$,y,x,_,C,S,E,w,N,j,O;function T(t,n){return t[2]?K:I}let P=T(n),A=P(n),L={ctx:n,current:null,token:null,hasCatch:!1,pending:V,then:R,catch:Q};z(f=n[7],L);let F=n[9]&&X(n),U=n[0],G=[];for(let t=0;t<U.length;t+=1)G[t]=et(W(n,U,t));let J=llusers,B=[];for(let t=0;t<J.length;t+=1)B[t]=ot(H(n,J,t));let M=n[1],q=[];for(let t=0;t<M.length;t+=1)q[t]=ut(D(n,M,t));return{c(){e=a("h1"),e.textContent="305FTW: automates garmin-USB to livelox.com",o=d(),A.c(),c=d(),l=a("div"),L.block.c(),h=d(),F&&F.c(),p=d(),g=a("h3"),g.textContent="Tracks",v=d(),b=a("table"),k=a("thead"),k.innerHTML='<tr class="svelte-1tg273s"><th class="svelte-1tg273s">Start</th> \n<th class="svelte-1tg273s">Duration</th> \n<th class="svelte-1tg273s"></th></tr>',$=d(),y=a("tbody");for(let t=0;t<G.length;t+=1)G[t].c();x=d(),_=a("h3"),_.textContent="Livelox Users",C=d(),S=a("div");for(let t=0;t<B.length;t+=1)B[t].c();E=d(),w=a("h3"),w.textContent="Events",N=d(),j=a("table"),O=a("tbody");for(let t=0;t<q.length;t+=1)q[t].c();m(e,"class","svelte-1tg273s"),m(b,"class","svelte-1tg273s"),m(S,"class","select"),m(j,"class","svelte-1tg273s")},m(t,n){s(t,e,n),s(t,o,n),A.m(t,n),s(t,c,n),s(t,l,n),L.block.m(l,L.anchor=null),L.mount=()=>l,L.anchor=null,s(t,h,n),F&&F.m(t,n),s(t,p,n),s(t,g,n),s(t,v,n),s(t,b,n),r(b,k),r(b,$),r(b,y);for(let t=0;t<G.length;t+=1)G[t]&&G[t].m(y,null);s(t,x,n),s(t,_,n),s(t,C,n),s(t,S,n);for(let t=0;t<B.length;t+=1)B[t]&&B[t].m(S,null);s(t,E,n),s(t,w,n),s(t,N,n),s(t,j,n),r(j,O);for(let t=0;t<q.length;t+=1)q[t]&&q[t].m(O,null)},p(t,e){if(P===(P=T(n=t))&&A?A.p(n,e):(A.d(1),A=P(n),A&&(A.c(),A.m(c.parentNode,c))),L.ctx=n,128&e[0]&&f!==(f=n[7])&&z(f,L),n[9]?F?F.p(n,e):(F=X(n),F.c(),F.m(p.parentNode,p)):F&&(F.d(1),F=null),8289&e[0]){let t;for(U=n[0],t=0;t<U.length;t+=1){const o=W(n,U,t);G[t]?G[t].p(o,e):(G[t]=et(o),G[t].c(),G[t].m(y,null))}for(;t<G.length;t+=1)G[t].d(1);G.length=U.length}if(0&e){let t;for(J=llusers,t=0;t<J.length;t+=1){const o=H(n,J,t);B[t]?B[t].p(o,e):(B[t]=ot(o),B[t].c(),B[t].m(S,null))}for(;t<B.length;t+=1)B[t].d(1);B.length=J.length}if(17666&e[0]){let t;for(M=n[1],t=0;t<M.length;t+=1){const o=D(n,M,t);q[t]?q[t].p(o,e):(q[t]=ut(o),q[t].c(),q[t].m(O,null))}for(;t<q.length;t+=1)q[t].d(1);q.length=M.length}},i:t,o:t,d(t){t&&u(e),t&&u(o),A.d(t),t&&u(c),t&&u(l),L.block.d(),L.token=null,L=null,t&&u(h),F&&F.d(t),t&&u(p),t&&u(g),t&&u(v),t&&u(b),i(G,t),t&&u(x),t&&u(_),t&&u(C),t&&u(S),i(B,t),t&&u(E),t&&u(w),t&&u(N),t&&u(j),i(q,t)}}}function at(t,n,e){let o,c,l,r,s,u,i,a,f,d,{name:h}=n,{tracks:p}=n,{events:m}=n,v=["192.168.1.6","192.168.1.8","192.168.1.7","172.20.10.2","172.20.10.3","172.20.10.4","172.20.10.5","172.20.10.6","172.20.10.7","172.20.10.8","172.20.10.9","172.20.10.10","172.20.10.11","172.20.10.12","172.20.10.13","172.20.10.14"],b=7,k=0,$=!1;function y(){e(9,$=!1);for(let t of v){let n="https://"+t+":5000";fetch(n).then((t=>t.json())).then((t=>{"ok"===t.status&&e(2,o=n),f=t.users,d=f[0],e(9,$=!1)})).catch((t=>{console.log(t),!o&&e(9,$="Could not connect to tethered backend")}))}}function _(t){e(9,$=!1),e(1,m=[]),e(5,l=t),e(6,r=fetch(o+"/loxcheck",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,track:t,username:d})}).then((t=>t.json())).then((t=>{e(1,m=t.events),i=t.lluid,a=t.myself})).catch((t=>{console.log(t),e(9,$="Error contacting livelox.com"),e(5,l=!1)})))}function C(t){e(9,$=!1),e(8,u=fetch(o+"/loxdone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,classid:t,lluid:i,myself:a})}).then((t=>{})).catch((t=>{console.log(t),e(9,$="Error confirming livelox event upload")})))}var S;S=()=>{y()},x().$$.on_mount.push(S);return t.$$set=t=>{"name"in t&&e(15,h=t.name),"tracks"in t&&e(0,p=t.tracks),"events"in t&&e(1,m=t.events)},[p,m,o,b,k,l,r,s,u,$,undefined,y,function(){e(9,$=!1),e(0,p=[]),e(1,m=[]),e(7,s=fetch(o+"/tracks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromdays:b,todays:k})}).then((t=>t.json())).then((t=>{e(0,p=t.tracks),c=t.id})).catch((t=>{console.log(t),e(9,$="Could not fetch GPS data from watch")})))},_,C,h,function(){b=g(this.value),e(3,b)},function(){k=g(this.value),e(4,k)},function(t){_(t.id)},function(t){C(t.id)}]}return new class extends q{constructor(t){super(),M(this,t,at,it,l,{name:15,tracks:0,events:1},null,[-1,-1])}}({target:document.body,props:{tracks:[],events:[]}})}();
//# sourceMappingURL=bundle.js.map
