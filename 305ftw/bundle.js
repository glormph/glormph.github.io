var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function c(t){return"function"==typeof t}function l(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function r(t,n){t.appendChild(n)}function s(t,n,e){t.insertBefore(n,e||null)}function u(t){t.parentNode&&t.parentNode.removeChild(t)}function i(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}function a(t){return document.createElement(t)}function f(t){return document.createTextNode(t)}function d(){return f(" ")}function h(){return f("")}function p(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function m(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function g(t){return""===t?null:+t}function v(t,n){n=""+n,t.data!==n&&(t.data=n)}function b(t,n){t.value=null==n?"":n}function k(t,n,e){for(let e=0;e<t.options.length;e+=1){const o=t.options[e];if(o.__value===n)return void(o.selected=!0)}e&&void 0===n||(t.selectedIndex=-1)}function $(t,n,e){t.classList[e?"add":"remove"](n)}let y;function x(t){y=t}function _(){if(!y)throw new Error("Function called outside component initialization");return y}const C=[],S=[];let E=[];const w=[],N=Promise.resolve();let j=!1;function O(t){E.push(t)}const T=new Set;let P=0;function A(){if(0!==P)return;const t=y;do{try{for(;P<C.length;){const t=C[P];P++,x(t),L(t.$$)}}catch(t){throw C.length=0,P=0,t}for(x(null),C.length=0,P=0;S.length;)S.pop()();for(let t=0;t<E.length;t+=1){const n=E[t];T.has(n)||(T.add(n),n())}E.length=0}while(C.length);for(;w.length;)w.pop()();j=!1,T.clear(),x(t)}function L(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(O)}}const F=new Set;let U;function z(t,n){t&&t.i&&(F.delete(t),t.i(n))}function G(t,n){const e=n.token={};function c(t,c,l,r){if(n.token!==e)return;n.resolved=r;let s=n.ctx;void 0!==l&&(s=s.slice(),s[l]=r);const u=t&&(n.current=t)(s);let i=!1;n.block&&(n.blocks?n.blocks.forEach(((t,e)=>{e!==c&&t&&(U={r:0,c:[],p:U},function(t,n,e,o){if(t&&t.o){if(F.has(t))return;F.add(t),U.c.push((()=>{F.delete(t),o&&(e&&t.d(1),o())})),t.o(n)}else o&&o()}(t,1,1,(()=>{n.blocks[e]===t&&(n.blocks[e]=null)})),U.r||o(U.c),U=U.p)})):n.block.d(1),u.c(),z(u,1),u.m(n.mount(),n.anchor),i=!0),n.block=u,n.blocks&&(n.blocks[c]=u),i&&A()}if(!(l=t)||"object"!=typeof l&&"function"!=typeof l||"function"!=typeof l.then){if(n.current!==n.then)return c(n.then,1,n.value,t),!0;n.resolved=t}else{const e=_();if(t.then((t=>{x(e),c(n.then,1,n.value,t),x(null)}),(t=>{if(x(e),c(n.catch,2,n.error,t),x(null),!n.hasCatch)throw t})),n.current!==n.pending)return c(n.pending,0),!0}var l}function J(t,n,e){const o=n.slice(),{resolved:c}=t;t.current===t.then&&(o[t.value]=c),t.current===t.catch&&(o[t.error]=c),t.block.p(o,e)}function q(t,n){const e=t.$$;null!==e.fragment&&(!function(t){const n=[],e=[];E.forEach((o=>-1===t.indexOf(o)?n.push(o):e.push(o))),e.forEach((t=>t())),E=n}(e.after_update),o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function B(t,n){-1===t.$$.dirty[0]&&(C.push(t),j||(j=!0,N.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function M(l,r,s,i,a,f,d,h=[-1]){const p=y;x(l);const m=l.$$={fragment:null,ctx:[],props:f,update:t,not_equal:a,bound:e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(p?p.$$.context:[])),callbacks:e(),dirty:h,skip_bound:!1,root:r.target||p.$$.root};d&&d(m.root);let g=!1;if(m.ctx=s?s(l,r.props||{},((t,n,...e)=>{const o=e.length?e[0]:n;return m.ctx&&a(m.ctx[t],m.ctx[t]=o)&&(!m.skip_bound&&m.bound[t]&&m.bound[t](o),g&&B(l,t)),n})):[],m.update(),g=!0,o(m.before_update),m.fragment=!!i&&i(m.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);m.fragment&&m.fragment.l(t),t.forEach(u)}else m.fragment&&m.fragment.c();r.intro&&z(l.$$.fragment),function(t,e,l,r){const{fragment:s,after_update:u}=t.$$;s&&s.m(e,l),r||O((()=>{const e=t.$$.on_mount.map(n).filter(c);t.$$.on_destroy?t.$$.on_destroy.push(...e):o(e),t.$$.on_mount=[]})),u.forEach(O)}(l,r.target,r.anchor,r.customElement),A()}x(p)}class D{$destroy(){q(this,1),this.$destroy=t}$on(n,e){if(!c(e))return t;const o=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return o.push(e),()=>{const t=o.indexOf(e);-1!==t&&o.splice(t,1)}}$set(t){var n;this.$$set&&(n=t,0!==Object.keys(n).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function H(t,n,e){const o=t.slice();return o[29]=n[e],o}function I(t,n,e){const o=t.slice();return o[32]=n[e],o}function W(t,n,e){const o=t.slice();return o[35]=n[e],o}function K(n){let e,o,c;return{c(){e=a("button"),e.textContent="Find backend",m(e,"class","svelte-1tg273s")},m(t,l){s(t,e,l),o||(c=p(e,"click",n[13]),o=!0)},p:t,d(t){t&&u(e),o=!1,c()}}}function Q(t){let n,e,c,l,r,i,h,v;return{c(){n=a("button"),n.textContent="Get tracks from watch",e=d(),c=a("input"),l=f("days ago until\n  "),r=a("input"),i=f("days ago"),m(n,"class","svelte-1tg273s"),m(c,"type","number"),m(c,"min","0"),m(c,"size","1"),m(r,"type","number"),m(r,"min","0"),m(r,"size","1")},m(o,u){s(o,n,u),s(o,e,u),s(o,c,u),b(c,t[3]),s(o,l,u),s(o,r,u),b(r,t[4]),s(o,i,u),h||(v=[p(n,"click",t[14]),p(c,"input",t[18]),p(r,"input",t[19])],h=!0)},p(t,n){8&n[0]&&g(c.value)!==t[3]&&b(c,t[3]),16&n[0]&&g(r.value)!==t[4]&&b(r,t[4])},d(t){t&&u(n),t&&u(e),t&&u(c),t&&u(l),t&&u(r),t&&u(i),h=!1,o(v)}}}function R(n){return{c:t,m:t,d:t}}function V(n){return{c:t,m:t,d:t}}function X(t){let n,e;return{c(){n=a("i"),e=f("Fetching GPS data from watch"),m(n,"class","fas fa-spinner fa-spin")},m(t,o){s(t,n,o),s(t,e,o)},d(t){t&&u(n),t&&u(e)}}}function Y(t){let n,e,o;return{c(){n=a("article"),e=f("An error occurred:\n"),o=f(t[9]),m(n,"class","svelte-1tg273s")},m(t,c){s(t,n,c),r(n,e),r(n,o)},p(t,n){512&n[0]&&v(o,t[9])},d(t){t&&u(n)}}}function Z(n){return{c:t,m:t,p:t,d:t}}function tt(t){let n,e,o;function c(){return t[20](t[35])}return{c(){n=a("button"),n.textContent="Check livelox",m(n,"class","svelte-1tg273s")},m(t,l){s(t,n,l),e||(o=p(n,"click",c),e=!0)},p(n,e){t=n},d(t){t&&u(n),e=!1,o()}}}function nt(t){let n,e,o,c=t[5]===t[35].id&&et();return{c(){n=a("button"),n.textContent="Check livelox",e=d(),c&&c.c(),o=h(),n.disabled=!0,m(n,"class","svelte-1tg273s")},m(t,l){s(t,n,l),s(t,e,l),c&&c.m(t,l),s(t,o,l)},p(t,n){t[5]===t[35].id?c||(c=et(),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(t){t&&u(n),t&&u(e),c&&c.d(t),t&&u(o)}}}function et(t){let n;return{c(){n=a("i"),m(n,"class","fas fa-spinner fa-pulse")},m(t,e){s(t,n,e)},d(t){t&&u(n)}}}function ot(t){let n,e,o,c,l,i,h,p,g,b,k,y,x=t[35].starttime+"",_=t[35].dur_min+"",C=String(t[35].dur_sec).padStart(2,"0")+"",S={ctx:t,current:null,token:null,hasCatch:!1,pending:nt,then:tt,catch:Z};return G(k=t[6],S),{c(){n=a("tr"),e=a("td"),o=f(x),c=d(),l=a("td"),i=f(_),h=f(":"),p=f(C),g=d(),b=a("td"),S.block.c(),y=d(),m(e,"class","svelte-1tg273s"),m(l,"class","svelte-1tg273s"),m(b,"class","svelte-1tg273s"),m(n,"class","svelte-1tg273s"),$(n,"active",t[5]===t[35].id)},m(t,u){s(t,n,u),r(n,e),r(e,o),r(n,c),r(n,l),r(l,i),r(l,h),r(l,p),r(n,g),r(n,b),S.block.m(b,S.anchor=null),S.mount=()=>b,S.anchor=null,r(n,y)},p(e,c){t=e,1&c[0]&&x!==(x=t[35].starttime+"")&&v(o,x),1&c[0]&&_!==(_=t[35].dur_min+"")&&v(i,_),1&c[0]&&C!==(C=String(t[35].dur_sec).padStart(2,"0")+"")&&v(p,C),S.ctx=t,64&c[0]&&k!==(k=t[6])&&G(k,S)||J(S,t,c),33&c[0]&&$(n,"active",t[5]===t[35].id)},d(t){t&&u(n),S.block.d(),S.token=null,S=null}}}function ct(t){let n,e,o,c=t[32]+"";return{c(){n=a("option"),e=f(c),n.__value=o=t[32],n.value=n.__value},m(t,o){s(t,n,o),r(n,e)},p(t,l){1024&l[0]&&c!==(c=t[32]+"")&&v(e,c),1024&l[0]&&o!==(o=t[32])&&(n.__value=o,n.value=n.__value)},d(t){t&&u(n)}}}function lt(n){return{c:t,m:t,p:t,d:t}}function rt(t){let n,e,o;function c(){return t[22](t[29])}return{c(){n=a("button"),n.textContent="Upload to this event",m(n,"class","svelte-1tg273s")},m(t,l){s(t,n,l),e||(o=p(n,"click",c),e=!0)},p(n,e){t=n},d(t){t&&u(n),e=!1,o()}}}function st(t){let n,e,o,c=t[12]===t[29].id&&ut();return{c(){n=a("button"),n.textContent="Upload to this event",e=d(),c&&c.c(),o=h(),n.disabled=!0,m(n,"class","svelte-1tg273s")},m(t,l){s(t,n,l),s(t,e,l),c&&c.m(t,l),s(t,o,l)},p(t,n){t[12]===t[29].id?c||(c=ut(),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(t){t&&u(n),t&&u(e),c&&c.d(t),t&&u(o)}}}function ut(t){let n;return{c(){n=a("i"),m(n,"class","fas fa-spinner fa-pulse")},m(t,e){s(t,n,e)},d(t){t&&u(n)}}}function it(t){let n,e,o,c,l,i,h,p,g,b=t[29].eventname+"",k=t[29].name+"",y={ctx:t,current:null,token:null,hasCatch:!1,pending:st,then:rt,catch:lt};return G(p=t[8],y),{c(){n=a("tr"),e=a("td"),o=f(b),c=f(", "),l=f(k),i=d(),h=a("td"),y.block.c(),g=d(),m(e,"class","svelte-1tg273s"),m(h,"class","svelte-1tg273s"),m(n,"class","svelte-1tg273s"),$(n,"active",t[12]===t[29].id)},m(t,u){s(t,n,u),r(n,e),r(e,o),r(e,c),r(e,l),r(n,i),r(n,h),y.block.m(h,y.anchor=null),y.mount=()=>h,y.anchor=null,r(n,g)},p(e,c){t=e,2&c[0]&&b!==(b=t[29].eventname+"")&&v(o,b),2&c[0]&&k!==(k=t[29].name+"")&&v(l,k),y.ctx=t,256&c[0]&&p!==(p=t[8])&&G(p,y)||J(y,t,c),4098&c[0]&&$(n,"active",t[12]===t[29].id)},d(t){t&&u(n),y.block.d(),y.token=null,y=null}}}function at(n){let e,o,c,l,f,h,g,v,b,$,y,x,_,C,S,E,w,N,j,T,P,A,L,F,U;function z(t,n){return t[2]?Q:K}let J=z(n),q=J(n),B={ctx:n,current:null,token:null,hasCatch:!1,pending:X,then:V,catch:R};G(f=n[7],B);let M=n[9]&&Y(n),D=n[0],Z=[];for(let t=0;t<D.length;t+=1)Z[t]=ot(W(n,D,t));let tt=n[10],nt=[];for(let t=0;t<tt.length;t+=1)nt[t]=ct(I(n,tt,t));let et=n[1],lt=[];for(let t=0;t<et.length;t+=1)lt[t]=it(H(n,et,t));return{c(){e=a("h1"),e.textContent="305FTW: automates garmin-USB to livelox.com",o=d(),q.c(),c=d(),l=a("div"),B.block.c(),h=d(),M&&M.c(),g=d(),v=a("h3"),v.textContent="Tracks",b=d(),$=a("table"),y=a("thead"),y.innerHTML='<tr class="svelte-1tg273s"><th class="svelte-1tg273s">Start</th> \n<th class="svelte-1tg273s">Duration</th> \n<th class="svelte-1tg273s"></th></tr>',x=d(),_=a("tbody");for(let t=0;t<Z.length;t+=1)Z[t].c();C=d(),S=a("h3"),S.textContent="Livelox Users",E=d(),w=a("div"),N=a("select");for(let t=0;t<nt.length;t+=1)nt[t].c();j=d(),T=a("h3"),T.textContent="Events",P=d(),A=a("table"),L=a("tbody");for(let t=0;t<lt.length;t+=1)lt[t].c();m(e,"class","svelte-1tg273s"),m($,"class","svelte-1tg273s"),void 0===n[11]&&O((()=>n[21].call(N))),m(w,"class","select"),m(A,"class","svelte-1tg273s")},m(t,u){s(t,e,u),s(t,o,u),q.m(t,u),s(t,c,u),s(t,l,u),B.block.m(l,B.anchor=null),B.mount=()=>l,B.anchor=null,s(t,h,u),M&&M.m(t,u),s(t,g,u),s(t,v,u),s(t,b,u),s(t,$,u),r($,y),r($,x),r($,_);for(let t=0;t<Z.length;t+=1)Z[t]&&Z[t].m(_,null);s(t,C,u),s(t,S,u),s(t,E,u),s(t,w,u),r(w,N);for(let t=0;t<nt.length;t+=1)nt[t]&&nt[t].m(N,null);k(N,n[11],!0),s(t,j,u),s(t,T,u),s(t,P,u),s(t,A,u),r(A,L);for(let t=0;t<lt.length;t+=1)lt[t]&&lt[t].m(L,null);F||(U=p(N,"change",n[21]),F=!0)},p(t,e){if(J===(J=z(n=t))&&q?q.p(n,e):(q.d(1),q=J(n),q&&(q.c(),q.m(c.parentNode,c))),B.ctx=n,128&e[0]&&f!==(f=n[7])&&G(f,B),n[9]?M?M.p(n,e):(M=Y(n),M.c(),M.m(g.parentNode,g)):M&&(M.d(1),M=null),32865&e[0]){let t;for(D=n[0],t=0;t<D.length;t+=1){const o=W(n,D,t);Z[t]?Z[t].p(o,e):(Z[t]=ot(o),Z[t].c(),Z[t].m(_,null))}for(;t<Z.length;t+=1)Z[t].d(1);Z.length=D.length}if(1024&e[0]){let t;for(tt=n[10],t=0;t<tt.length;t+=1){const o=I(n,tt,t);nt[t]?nt[t].p(o,e):(nt[t]=ct(o),nt[t].c(),nt[t].m(N,null))}for(;t<nt.length;t+=1)nt[t].d(1);nt.length=tt.length}if(3072&e[0]&&k(N,n[11]),69890&e[0]){let t;for(et=n[1],t=0;t<et.length;t+=1){const o=H(n,et,t);lt[t]?lt[t].p(o,e):(lt[t]=it(o),lt[t].c(),lt[t].m(L,null))}for(;t<lt.length;t+=1)lt[t].d(1);lt.length=et.length}},i:t,o:t,d(t){t&&u(e),t&&u(o),q.d(t),t&&u(c),t&&u(l),B.block.d(),B.token=null,B=null,t&&u(h),M&&M.d(t),t&&u(g),t&&u(v),t&&u(b),t&&u($),i(Z,t),t&&u(C),t&&u(S),t&&u(E),t&&u(w),i(nt,t),t&&u(j),t&&u(T),t&&u(P),t&&u(A),i(lt,t),F=!1,U()}}}function ft(t,n,e){let o,c,l,r,s,u,i,a,f,{name:d}=n,{tracks:h}=n,{events:p}=n,m=["192.168.1.6","192.168.1.8","192.168.1.7","172.20.10.2","172.20.10.3","172.20.10.4","172.20.10.5","172.20.10.6","172.20.10.7","172.20.10.8","172.20.10.9","172.20.10.10","172.20.10.11","172.20.10.12","172.20.10.13","172.20.10.14"],v=7,b=0,k=!1,$=[];function y(){e(9,k=!1);for(let t of m){let n="https://"+t+":5000";fetch(n).then((t=>t.json())).then((t=>{"ok"===t.status&&e(2,o=n),e(10,$=t.users),e(11,f=$[0]),e(9,k=!1)})).catch((t=>{console.log(t),!o&&e(9,k="Could not connect to tethered backend")}))}}function x(t){e(9,k=!1),e(1,p=[]),e(5,l=t),e(6,r=fetch(o+"/loxcheck",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,track:t,username:f})}).then((t=>t.json())).then((t=>{e(1,p=t.events),i=t.lluid,a=t.myself})).catch((t=>{console.log(t),e(9,k="Error contacting livelox.com"),e(5,l=!1)})))}function C(t){e(9,k=!1),e(8,u=fetch(o+"/loxdone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:c,classid:t,lluid:i,myself:a})}).then((t=>{})).catch((t=>{console.log(t),e(9,k="Error confirming livelox event upload")})))}var S;S=()=>{y()},_().$$.on_mount.push(S);return t.$$set=t=>{"name"in t&&e(17,d=t.name),"tracks"in t&&e(0,h=t.tracks),"events"in t&&e(1,p=t.events)},[h,p,o,v,b,l,r,s,u,k,$,f,undefined,y,function(){e(9,k=!1),e(0,h=[]),e(1,p=[]),e(7,s=fetch(o+"/tracks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromdays:v,todays:b})}).then((t=>t.json())).then((t=>{e(0,h=t.tracks),c=t.id})).catch((t=>{console.log(t),e(9,k="Could not fetch GPS data from watch")})))},x,C,d,function(){v=g(this.value),e(3,v)},function(){b=g(this.value),e(4,b)},function(t){x(t.id)},function(){f=function(t){const n=t.querySelector(":checked");return n&&n.__value}(this),e(11,f),e(10,$)},function(t){C(t.id)}]}return new class extends D{constructor(t){super(),M(this,t,ft,at,l,{name:17,tracks:0,events:1},null,[-1,-1])}}({target:document.body,props:{tracks:[],events:[]}})}();
//# sourceMappingURL=bundle.js.map
